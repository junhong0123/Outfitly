@model List<Outfitly.Models.Order>
@{
    ViewData["Title"] = "My Orders";
}

<div class="min-h-screen bg-gray-50 py-12">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
        <!-- Header -->
        <div class="mb-8">
            <h1 class="text-3xl md:text-4xl font-light text-black">My Orders</h1>
            <p class="text-gray-500 mt-2">Track and manage your order history</p>
        </div>

        <!-- Status Filter -->
        <div class="mb-6 flex flex-wrap gap-2">
            <a href="@Url.Action("MyOrders", new { status = "all" })" 
               class="px-4 py-2 text-sm rounded-full border transition @(ViewBag.SelectedStatus == "all" ? "bg-black text-white border-black" : "bg-white text-gray-700 border-gray-300 hover:border-black")">
                All Orders
            </a>
            <a href="@Url.Action("MyOrders", new { status = "pending" })" 
               class="px-4 py-2 text-sm rounded-full border transition @(ViewBag.SelectedStatus == "pending" ? "bg-black text-white border-black" : "bg-white text-gray-700 border-gray-300 hover:border-black")">
                Pending
            </a>
            <a href="@Url.Action("MyOrders", new { status = "processing" })" 
               class="px-4 py-2 text-sm rounded-full border transition @(ViewBag.SelectedStatus == "processing" ? "bg-black text-white border-black" : "bg-white text-gray-700 border-gray-300 hover:border-black")">
                Processing
            </a>
            <a href="@Url.Action("MyOrders", new { status = "shipped" })" 
               class="px-4 py-2 text-sm rounded-full border transition @(ViewBag.SelectedStatus == "shipped" ? "bg-black text-white border-black" : "bg-white text-gray-700 border-gray-300 hover:border-black")">
                Shipped
            </a>
            <a href="@Url.Action("MyOrders", new { status = "delivered" })" 
               class="px-4 py-2 text-sm rounded-full border transition @(ViewBag.SelectedStatus == "delivered" ? "bg-black text-white border-black" : "bg-white text-gray-700 border-gray-300 hover:border-black")">
                Delivered
            </a>
        </div>

        <!-- Orders List -->
        @if (Model.Any())
        {
            <div class="space-y-6">
                @foreach (var order in Model)
                {
                    <div class="bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
                        <!-- Order Header -->
                        <div class="px-6 py-4 bg-gray-50 border-b border-gray-200 flex flex-wrap justify-between items-center gap-4">
                            <div class="flex flex-wrap items-center gap-4 md:gap-8">
                                <div>
                                    <span class="text-xs text-gray-500 uppercase tracking-wide">Order #</span>
                                    <p class="font-medium text-black">@order.Id.ToString("D5")</p>
                                </div>
                                <div>
                                    <span class="text-xs text-gray-500 uppercase tracking-wide">Date</span>
                                    <p class="text-gray-700">@order.OrderDate.ToString("MMM dd, yyyy")</p>
                                </div>
                                <div>
                                    <span class="text-xs text-gray-500 uppercase tracking-wide">Total</span>
                                    <p class="font-medium text-black">$@order.TotalAmount.ToString("F2")</p>
                                </div>
                            </div>
                            <div class="flex items-center gap-3">
                                @{
                                    var statusColor = order.Status switch
                                    {
                                        "Pending" => "bg-yellow-100 text-yellow-800",
                                        "Processing" => "bg-blue-100 text-blue-800",
                                        "Shipped" => "bg-purple-100 text-purple-800",
                                        "Delivered" => "bg-green-100 text-green-800",
                                        "Cancelled" => "bg-red-100 text-red-800",
                                        _ => "bg-gray-100 text-gray-800"
                                    };
                                }
                                <span class="px-3 py-1 text-xs font-medium rounded-full @statusColor">
                                    @order.Status
                                </span>
                            </div>
                        </div>

                        <!-- Order Items -->
                        <div class="px-6 py-4 divide-y divide-gray-100">
                            @foreach (var item in order.OrderItems)
                            {
                                <div class="py-4 flex items-center gap-4 first:pt-0 last:pb-0">
                                    <!-- Product Image -->
                                    <div class="w-16 h-16 bg-gray-100 rounded flex-shrink-0">
                                        @if (item.Product?.ImageUrl != null)
                                        {
                                            <img src="@item.Product.ImageUrl" alt="@item.Product.Name" class="w-full h-full object-cover rounded">
                                        }
                                        else
                                        {
                                            <div class="w-full h-full flex items-center justify-center text-gray-400">
                                                <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
                                                </svg>
                                            </div>
                                        }
                                    </div>
                                    <!-- Product Details -->
                                    <div class="flex-grow">
                                        <h4 class="font-medium text-black">@(item.Product?.Name ?? "Unknown Product")</h4>
                                        <p class="text-sm text-gray-500">Qty: @item.Quantity × $@item.PriceAtPurchase.ToString("F2")</p>
                                    </div>
                                    <!-- Item Total -->
                                    <div class="text-right">
                                        <p class="font-medium text-black">$@((item.Quantity * item.PriceAtPurchase).ToString("F2"))</p>
                                    </div>
                                </div>
                            }
                        </div>

                        <!-- Order Footer -->
                        <div class="px-6 py-4 bg-gray-50 border-t border-gray-200 flex justify-between items-center">
                            <p class="text-sm text-gray-500">
                                @order.OrderItems.Sum(i => i.Quantity) item(s)
                            </p>
                            <a asp-action="OrderDetails" asp-route-id="@order.Id" 
                               class="text-sm font-medium text-black hover:underline">
                                View Details →
                            </a>
                        </div>
                    </div>
                }
            </div>
        }
        else
        {
            <!-- Empty State -->
            <div class="bg-white rounded-lg shadow-sm border border-gray-200 px-6 py-16 text-center">
                <svg class="w-16 h-16 mx-auto text-gray-300 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z" />
                </svg>
                <h3 class="text-lg font-medium text-gray-900 mb-2">No orders yet</h3>
                <p class="text-gray-500 mb-6">Start shopping to see your orders here!</p>
                <a asp-controller="Products" asp-action="Index" 
                   class="inline-block bg-black text-white px-6 py-3 text-sm font-medium hover:bg-gray-800 transition">
                    Browse Products
                </a>
            </div>
        }
    </div>
</div>
